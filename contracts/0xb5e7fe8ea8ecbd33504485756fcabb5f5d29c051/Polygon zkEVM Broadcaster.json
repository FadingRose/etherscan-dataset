{
  "TxHash": "0xb990ecddd5759940e09a4247052b47d4e488f8fd84b0e5e9defd4680ca6f6714",
  "ContractAddress": "0xb5e7fe8ea8ecbd33504485756fcabb5f5d29c051",
  "Name": "Polygon zkEVM Broadcaster",
  "PackageStatus": 0,
  "status": "1",
  "message": "OK",
  "result": [
    {
      "SourceCode": "# pragma version 0.3.10\r\n\"\"\"\r\n@title Polygon zkEVM Broadcaster\r\n@author CurveFi\r\n@license MIT\r\n@custom:version 1.0.1\r\n\"\"\"\r\n\r\n\r\nversion: public(constant(String[8])) = \"1.0.1\"\r\n\r\n\r\ninterface PolygonZkEVMBridge:\r\n    def bridgeMessage(destination_network: uint32, destination_address: address, force_update: bool, metadata: Bytes[MAX_MESSAGE_RECEIVED]): payable\r\n\r\n\r\nevent Broadcast:\r\n    chain_id: indexed(uint256)\r\n    agent: indexed(Agent)\r\n    messages: DynArray[Message, MAX_MESSAGES]\r\n\r\n\r\nevent SetDestinationData:\r\n    chain_id: indexed(uint256)\r\n    data: DestinationData\r\n\r\n\r\nevent SetNewBridge:\r\n    new_bridge: PolygonZkEVMBridge\r\n\r\n\r\nevent SetNewDestinationNetwork:\r\n    new_network: uint32\r\n\r\n\r\nevent ApplyAdmins:\r\n    admins: AdminSet\r\n\r\nevent CommitAdmins:\r\n    future_admins: AdminSet\r\n\r\n\r\nenum Agent:\r\n    OWNERSHIP\r\n    PARAMETER\r\n    EMERGENCY\r\n\r\n\r\nstruct AdminSet:\r\n    ownership: address\r\n    parameter: address\r\n    emergency: address\r\n\r\nstruct Message:\r\n    target: address\r\n    data: Bytes[MAX_BYTES]\r\n\r\n\r\nstruct DestinationData:\r\n    network: uint32\r\n    relayer: address\r\n\r\n\r\nMAX_BYTES: constant(uint256) = 1024\r\nMAX_MESSAGES: constant(uint256) = 8\r\nMAX_MESSAGE_RECEIVED: constant(uint256) = 9400\r\n\r\n\r\nadmins: public(AdminSet)\r\nfuture_admins: public(AdminSet)\r\n\r\ndestination_data: public(HashMap[uint256, DestinationData])\r\nagent: public(HashMap[address, Agent])\r\n\r\nPOLYGON_ZKEVM_BRIDGE: public(immutable(PolygonZkEVMBridge))\r\n\r\n\r\n@external\r\ndef __init__(_admins: AdminSet, _polygon_zkevm_bridge: PolygonZkEVMBridge):\r\n    assert _admins.ownership != _admins.parameter  # a != b\r\n    assert _admins.ownership != _admins.emergency  # a != c\r\n    assert _admins.parameter != _admins.emergency  # b != c\r\n\r\n    self.admins = _admins\r\n\r\n    self.agent[_admins.ownership] = Agent.OWNERSHIP\r\n    self.agent[_admins.parameter] = Agent.PARAMETER\r\n    self.agent[_admins.emergency] = Agent.EMERGENCY\r\n\r\n    POLYGON_ZKEVM_BRIDGE = _polygon_zkevm_bridge\r\n\r\n    log ApplyAdmins(_admins)\r\n\r\n\r\n@external\r\ndef broadcast(_chain_id: uint256, _messages: DynArray[Message, MAX_MESSAGES], _force_update: bool=True, _destination_data: DestinationData=empty(DestinationData)):\r\n    \"\"\"\r\n    @notice Broadcast a sequence of messages.\r\n    @dev Save `depositCount` from POLYGON_ZKEVM_BRIDGE.BridgeEvent to claim message on destination chain\r\n    @param _chain_id Chain ID of L2\r\n    @param _messages The sequence of messages to broadcast.\r\n    @param _force_update Indicates if the new global exit root is updated or not (forceUpdateGlobalExitRoot)\r\n    @param _destination_data Specific DestinationData (self.destination_data by default)\r\n    \"\"\"\r\n    agent: Agent = self.agent[msg.sender]\r\n    assert agent != empty(Agent)\r\n    destination: DestinationData = _destination_data\r\n    if destination.relayer == empty(address):\r\n        destination = self.destination_data[_chain_id]\r\n    assert destination.relayer != empty(address)\r\n\r\n    POLYGON_ZKEVM_BRIDGE.bridgeMessage(destination.network, destination.relayer, _force_update,\r\n        _abi_encode(  # relay(uint256,(address,bytes)[])\r\n            agent,\r\n            _messages,\r\n            method_id=method_id(\"relay(uint256,(address,bytes)[])\"),\r\n        ),\r\n    )\r\n\r\n    log Broadcast(_chain_id, agent, _messages)\r\n\r\n\r\n@external\r\ndef set_destination_data(_chain_id: uint256, _destination_data: DestinationData):\r\n    \"\"\"\r\n    @notice Set destination data for child chain.\r\n    \"\"\"\r\n    assert msg.sender == self.admins.ownership\r\n    self.destination_data[_chain_id] = _destination_data\r\n    log SetDestinationData(_chain_id, _destination_data)\r\n\r\n\r\n@external\r\ndef commit_admins(_future_admins: AdminSet):\r\n    \"\"\"\r\n    @notice Commit an admin set to use in the future.\r\n    \"\"\"\r\n    assert msg.sender == self.admins.ownership\r\n\r\n    assert _future_admins.ownership != _future_admins.parameter  # a != b\r\n    assert _future_admins.ownership != _future_admins.emergency  # a != c\r\n    assert _future_admins.parameter != _future_admins.emergency  # b != c\r\n\r\n    self.future_admins = _future_admins\r\n    log CommitAdmins(_future_admins)\r\n\r\n\r\n@external\r\ndef apply_admins():\r\n    \"\"\"\r\n    @notice Apply the future admin set.\r\n    \"\"\"\r\n    admins: AdminSet = self.admins\r\n    assert msg.sender == admins.ownership\r\n\r\n    # reset old admins\r\n    self.agent[admins.ownership] = empty(Agent)\r\n    self.agent[admins.parameter] = empty(Agent)\r\n    self.agent[admins.emergency] = empty(Agent)\r\n\r\n    # set new admins\r\n    future_admins: AdminSet = self.future_admins\r\n    self.agent[future_admins.ownership] = Agent.OWNERSHIP\r\n    self.agent[future_admins.parameter] = Agent.PARAMETER\r\n    self.agent[future_admins.emergency] = Agent.EMERGENCY\r\n\r\n    self.admins = future_admins\r\n    log ApplyAdmins(future_admins)",
      "ABI": "[{\"name\":\"Broadcast\",\"inputs\":[{\"name\":\"chain_id\",\"type\":\"uint256\",\"indexed\":true},{\"name\":\"agent\",\"type\":\"uint256\",\"indexed\":true},{\"name\":\"messages\",\"type\":\"tuple[]\",\"components\":[{\"name\":\"target\",\"type\":\"address\"},{\"name\":\"data\",\"type\":\"bytes\"}],\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"SetDestinationData\",\"inputs\":[{\"name\":\"chain_id\",\"type\":\"uint256\",\"indexed\":true},{\"name\":\"data\",\"type\":\"tuple\",\"components\":[{\"name\":\"network\",\"type\":\"uint32\"},{\"name\":\"relayer\",\"type\":\"address\"}],\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"SetNewBridge\",\"inputs\":[{\"name\":\"new_bridge\",\"type\":\"address\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"SetNewDestinationNetwork\",\"inputs\":[{\"name\":\"new_network\",\"type\":\"uint32\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"ApplyAdmins\",\"inputs\":[{\"name\":\"admins\",\"type\":\"tuple\",\"components\":[{\"name\":\"ownership\",\"type\":\"address\"},{\"name\":\"parameter\",\"type\":\"address\"},{\"name\":\"emergency\",\"type\":\"address\"}],\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"CommitAdmins\",\"inputs\":[{\"name\":\"future_admins\",\"type\":\"tuple\",\"components\":[{\"name\":\"ownership\",\"type\":\"address\"},{\"name\":\"parameter\",\"type\":\"address\"},{\"name\":\"emergency\",\"type\":\"address\"}],\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"stateMutability\":\"nonpayable\",\"type\":\"constructor\",\"inputs\":[{\"name\":\"_admins\",\"type\":\"tuple\",\"components\":[{\"name\":\"ownership\",\"type\":\"address\"},{\"name\":\"parameter\",\"type\":\"address\"},{\"name\":\"emergency\",\"type\":\"address\"}]},{\"name\":\"_polygon_zkevm_bridge\",\"type\":\"address\"}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"broadcast\",\"inputs\":[{\"name\":\"_chain_id\",\"type\":\"uint256\"},{\"name\":\"_messages\",\"type\":\"tuple[]\",\"components\":[{\"name\":\"target\",\"type\":\"address\"},{\"name\":\"data\",\"type\":\"bytes\"}]}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"broadcast\",\"inputs\":[{\"name\":\"_chain_id\",\"type\":\"uint256\"},{\"name\":\"_messages\",\"type\":\"tuple[]\",\"components\":[{\"name\":\"target\",\"type\":\"address\"},{\"name\":\"data\",\"type\":\"bytes\"}]},{\"name\":\"_force_update\",\"type\":\"bool\"}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"broadcast\",\"inputs\":[{\"name\":\"_chain_id\",\"type\":\"uint256\"},{\"name\":\"_messages\",\"type\":\"tuple[]\",\"components\":[{\"name\":\"target\",\"type\":\"address\"},{\"name\":\"data\",\"type\":\"bytes\"}]},{\"name\":\"_force_update\",\"type\":\"bool\"},{\"name\":\"_destination_data\",\"type\":\"tuple\",\"components\":[{\"name\":\"network\",\"type\":\"uint32\"},{\"name\":\"relayer\",\"type\":\"address\"}]}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"set_destination_data\",\"inputs\":[{\"name\":\"_chain_id\",\"type\":\"uint256\"},{\"name\":\"_destination_data\",\"type\":\"tuple\",\"components\":[{\"name\":\"network\",\"type\":\"uint32\"},{\"name\":\"relayer\",\"type\":\"address\"}]}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"commit_admins\",\"inputs\":[{\"name\":\"_future_admins\",\"type\":\"tuple\",\"components\":[{\"name\":\"ownership\",\"type\":\"address\"},{\"name\":\"parameter\",\"type\":\"address\"},{\"name\":\"emergency\",\"type\":\"address\"}]}],\"outputs\":[]},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"apply_admins\",\"inputs\":[],\"outputs\":[]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"version\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"string\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"admins\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"tuple\",\"components\":[{\"name\":\"ownership\",\"type\":\"address\"},{\"name\":\"parameter\",\"type\":\"address\"},{\"name\":\"emergency\",\"type\":\"address\"}]}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"future_admins\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"tuple\",\"components\":[{\"name\":\"ownership\",\"type\":\"address\"},{\"name\":\"parameter\",\"type\":\"address\"},{\"name\":\"emergency\",\"type\":\"address\"}]}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"destination_data\",\"inputs\":[{\"name\":\"arg0\",\"type\":\"uint256\"}],\"outputs\":[{\"name\":\"\",\"type\":\"tuple\",\"components\":[{\"name\":\"network\",\"type\":\"uint32\"},{\"name\":\"relayer\",\"type\":\"address\"}]}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"agent\",\"inputs\":[{\"name\":\"arg0\",\"type\":\"address\"}],\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"POLYGON_ZKEVM_BRIDGE\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}]}]",
      "ContractName": "Polygon zkEVM Broadcaster",
      "CompilerVersion": "vyper:0.3.10",
      "OptimizationUsed": "0",
      "Runs": "0",
      "ConstructorArguments": "00000000000000000000000071f718d3e4d1449d1502a6a7595eb84ebccb16830000000000000000000000004eeb3ba4f221ca16ed4a0cc7254e2e32df948c5f000000000000000000000000467947ee34af926cf1dcac093870f613c96b1e0c0000000000000000000000002a3dd3eb832af982ec71669e178424b10dca2ede",
      "EVMVersion": "Default",
      "Library": "",
      "LicenseType": "MIT",
      "Proxy": "0",
      "Implementation": "",
      "SwarmSource": ""
    }
  ]
}
